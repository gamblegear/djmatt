{% extends "bootstrap_base.html" %}
{% load url from future %}
{% load staticfiles %}

 {% block title %} Update User Info
{% endblock %} 

{% block script %}
<script src="{% static 'js/sprintf.min.js' %}"></script>
<script src="{% static 'js/jquery.blockUI.js' %}"></script>

{% endblock %} 

{% block script_end_body %}
<script type="text/javascript">setNavActive("nav_1")</script>


<style type="text/css">
.mine {
}
/* This imageless css button was generated by CSSButtonGenerator.com */
.mine_clicked {
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ffce79), color-stop(1, #eeaf41) );
	background:-moz-linear-gradient( center top, #ffce79 5%, #eeaf41 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffce79', endColorstr='#eeaf41');
	background-color:#ffce79;
	border:1px solid #333333;
	display:inline-block;
	color:#ffffff;
    }
</style>




<script>

function initTable(){
	var panel_id_status_dict = {{ panel_id_status_json|safe }};
	var th_html = "<tr><th style='text-align:center; width:120px'>Click to Switch</th><th style='text-align:center'>Progress</th></tr>";
	var rowshtml = th_html
	var rowFormat = "<tr><td style='text-align:center;'>"
					+"<a id='btn%s' class='btn' href='%s' name='panel_id'>%s</a>"
					+"</td><td>"
					+"<div class='progressbar' id='pb%s'>"
					+"<span class='value_text' style='position:absolute; margin-top:3px; font-weight:bold;'>"
					+"</span></div></td></tr>";
	var count = 1
	for (panelId in panel_id_status_dict){
		var tmp = sprintf(rowFormat, 
							panelId, 
							"{% url 'mine.views.mine_field_view' 0 panel_id %}".replace(0, panelId),
							panel_id_status_dict[panelId]['panel_name'], 
							panelId)   
		rowshtml += tmp
		count++;
	}
	$("#switch_table").html(rowshtml)
	$(".progressbar").progressbar();
	
	var fromPanelId = "{{panel_id|safe}}";
	var btnIdFormat = "#btn%s";
	var btnId = sprintf(btnIdFormat, fromPanelId)
	$(btnId).attr("disabled", "disabled").on("click", function() {
	    return false; 
	});
	
	for (panelId in panel_id_status_dict){
		var pbIdFormat = "#pb%s";
		var pbId = sprintf(pbIdFormat, panelId)
		var current = panel_id_status_dict[panelId]['current']
		var total = panel_id_status_dict[panelId]['total']
		$(pbId).progressbar({
			value : current,
			total : total
		})
		//.children('.ui-progressbar-value')
	    //.html(current.toString() + " / " + total.toString())
	    //.css({"display": "block", "text-align": "center"});
		
		$(pbId).children('.value_text').html(current.toString() + " / " + total.toString())
		$(pbId).children('.value_text').css('margin-left', ($(pbId).width()-$(pbId).children('.value_text').width())/2 )
	}
}


$(document).ready(initTable);

$(document).ready(function(){
	
	$(".btn").click(function() {
		$("#panel_name").val($(this).html())
	});
	
});


</script>
 
{% endblock %} {% block body %}

<h1>Mine Field: </h1>
<hr />

<div class="container">
    <div id="mine_filed"></div>
    <form id="myform" action="{% url 'mine.views.switched_view'%}" method="post">
    {% csrf_token %}
    	<input type="hidden" name="from_panel_id" value="{{panel_id}}">
    	<input type="hidden" name="from_group_name" value="{{group_name}}">
    	<input type="hidden" name="from_panel_name" value="{{panel_name}}">
    	<input type="hidden" name="group_name" value="{{group_name}}">
    	<input type="hidden" id="panel_name" name="panel_name" value="">
	    <table class="table table-hover table-bordered" id="switch_table">
		</table>
	</form>

</div>




{% endblock %}



