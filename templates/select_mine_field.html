{% extends "bootstrap_base.html" %}
{% load url from future %}
{% load staticfiles %}

 {% block title %} Update User Info
{% endblock %} 

{% block script %}
<link href="{% static 'select2/select2.css' %} " rel="stylesheet"/>
<script src="{% static 'js/sprintf.min.js' %}"></script>
<script src="{% static 'js/jquery.blockUI.js' %}"></script>
<script src="{% static 'select2/select2.min.js' %}"></script>

{% endblock %} 

{% block script_end_body %}
<script type="text/javascript">setNavActive("nav_1")</script>


<style type="text/css">
.mine {
}
/* This imageless css button was generated by CSSButtonGenerator.com */
.mine_clicked {
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ffce79), color-stop(1, #eeaf41) );
	background:-moz-linear-gradient( center top, #ffce79 5%, #eeaf41 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffce79', endColorstr='#eeaf41');
	background-color:#ffce79;
	border:1px solid #333333;
	display:inline-block;
	color:#ffffff;
    }
</style>




<script>

function initSelsector(){
	$("#group_id").select2()
	$("#panel_id").select2()
	$("#group_id").html("<option>caocao</option>")

    //initial group select options
    //var groupOptionFormat = "<option value='%s'>Group %d</option>"
   	var groupOptionFormat = "<option value='%s'>%s</option>"
    var groupPanelsDict = {{ group_panels_json|safe }};

    var groupSelectorOptionsHtml = ''
    var counter = 1
    for (var groupId in groupPanelsDict){
       var tmp = sprintf(groupOptionFormat, groupId, groupPanelsDict[groupId]['group_name'])
       counter = counter + 1;
       groupSelectorOptionsHtml += tmp
    }

	$("#group_id").html(groupSelectorOptionsHtml)
    $("#group_id").change(function(){
        var groupIdSelected = $(this).val();
        //var panelOptionFormat = "<option value='%s'>Panel %d</option>"
       	var panelOptionFormat = "<option value='%s'>%s</option>"
        var panelSelectorOptionsHtml = ''
        var counter = 1
        panelsDict = groupPanelsDict[groupIdSelected]['panels']
        for (var panelID in panelsDict ){
            var tmp = sprintf(panelOptionFormat, panelID, panelsDict[panelID])
            counter = counter + 1
            panelSelectorOptionsHtml += tmp
        }
        
        $("#panel_id").html(panelSelectorOptionsHtml)
        $("#panel_id").val('').trigger('change')
        console.log($("#panel_id").text())
    })
    
    $("#group_id").val('').trigger('change')
}

$(document).ready(initSelsector);

$(document).ready(function(){
	$("#myform").submit(function(){
		$("#group_name").val($("#group_id option:selected").text())
		$("#panel_name").val($("#panel_id option:selected").text())
		$("#myform").attr('action', "{% url 'mine.views.mine_field_view' 0 %}".replace(0, $("#panel_id").val()));
		return true;
	});
	
});

</script>
 
{% endblock %} {% block body %}

<h1>Mine Field: </h1>
<hr />

<div class="container">
<form id="myform" class="form-horizontal"  action="" method="post">
{% csrf_token %}
<input type="hidden" id="game_id" name='game_id' value="-1">
<input type="hidden" id="group_name" name='group_name' value="-1">
<input type="hidden" id="panel_name" name='panel_name' value="-1">
	<div class="control-group" >
		<label class="control-label" for="name">Group:</label>
		<div class="controls">
            <select id='group_id' name='group_id'>
            </select>
		</div>
	</div>
	
	<div class="control-group" >
		<label class="control-label" for="name">Panel:</label>
		<div class="controls">
            <select id='panel_id' name='panel_id'>
            </select>
		</div>
	</div>
    <div class="control-group">
        <div class="controls">
          <button type="submit" class="btn btn-primary">Enter</button>
        </div>
    </div>
</form>
</div>


{% endblock %}
